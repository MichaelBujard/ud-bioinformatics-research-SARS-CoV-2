# (4) another plot
# Plot
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "summary", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
theme_minimal() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0))) +
ggtitle("Snippet Occurrence Per Sequence Comparison")
# (4) another plot
# Plot
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "summary", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
theme_minimal() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0))) +
ggtitle("\t Snippet Occurrence Per Sequence Comparison")
# (4) another plot
# Plot
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "summary", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
theme_minimal() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0))) +
ggtitle("\t\t Snippet Occurrence Per Sequence Comparison")
# (4) another plot
# Plot
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "summary", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
theme_minimal() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0))) +
ggtitle("Snippet Occurrence Per Sequence Comparison", Position = "center")
# (4) another plot
# Plot
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "summary", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
theme_minimal() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0))) +
ggtitle("Snippet Occurrence Per Sequence Comparison", position = "center")
# (4) another plot
# Plot
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "summary", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
theme_minimal() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0))) +
ggtitle("Snippet Occurrence Per Sequence Comparison",
hjust = 0.5)
# (4) another plot
# Plot
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "summary", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
theme_minimal() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0))) +
ggtitle("Snippet Occurrence Per Sequence Comparison",
hjust = 1)
# (4) another plot
# Plot
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "summary", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
# (4) another plot
# Plot
ggplot(df) +
geom_bar(aes(group, values, fill = group), width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
# (4) another plot
# Plot
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "identity", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
# (4) another plot
# Plot
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "identity", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 10,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
# (4) another plot
# Plot
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "identity", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 8,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
# (4) another plot
# Plot
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "identity", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
size = 7,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
# (4) another plot
# Plot
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "identity", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 7,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
# (4) another plot
# Plot
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "identity", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 6,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
# (4) another plot
# Plot
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "identity", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
# Plot
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "summary", fun.y = "sum") +
ylab("Frequency") +
xlab("Accession Pairs") +
theme_minimal() +
theme(legend.position = "none")
# (5) another plot
ggplot(df) +
geom_col(aes(group, values, fill = group), stat = "identity", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
ggplot(df) +
geom_boxplot(aes(group, values, fill = group), stat = "identity") +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
rlang::last_error()
ggplot(df) +
geom_boxplot(aes(group,
values,
fill = group,
lower = 0,
upper = 154,
middle = 77,
ymin = 0,
ymax = 31), stat = "identity") +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
library(data.table)
library(ggplot2)
snippets <- read.csv(file = '22_snippet_occurrences.csv')
head(snippets)
head(snippets)
column_names <- snippets$SEQUENCE_PAIRS
snippet_table <- table(snippets$AA_MISMATCHES)
print(snippet_table)
snippet_table <- table(snippets$AA_MISMATCHES)
print(snippet_table)
plot(snippet_table)
barplot(snippet_table,
col='dark red',
sep='black',
main="Frequency vs. Pairs",
xlab="Snippet Occurrence Frequency",
ylab="Spike Protein Sequence Pairs",
xlim=c(0,30),
ylim=c(0,40)
)
# get data and organize it as a data frame
df <- data.frame(group = c(rep(snippets$SEQUENCE_PAIRS)),
values = snippets$AA_MISMATCHES)
# Plot
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "summary", fun.y = "sum") +
ylab("Frequency") +
xlab("Accession Pairs") +
theme_minimal() +
theme(legend.position = "none")
# (4) another plot
# Plot
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "identity", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
# (5) another plot
ggplot(df) +
geom_col(aes(group, values, fill = group), stat = "identity", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
ggplot(df) +
geom_boxplot(aes(group,
values,
fill = group,
lower = 0,
upper = 154,
middle = 77,
ymin = 0,
ymax = 31), stat = "identity") +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
rlang::last_error()
# Clear environment
rm(list = ls())
# Clear packages
detach("Package:ggplot2", unload = TRUE)
detach("package:data.table", unload = TRUE)
# Clear plots
dev.off()  # But only if there IS a plot
# Clear console
cat("\014")  # ctrl+L
# a slightly more aesthetic visualization with title and x-, y-labels.
barplot(snippet_table,
col='dark red',
sep='black',
main="Frequency vs. Pairs",
xlab="Snippet Occurrence Frequency",
ylab="Spike Protein Sequence Pairs",
xlim=c(0,30),
ylim=c(0,40)
)
# another plot, trying different params to check output
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "identity", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
library(data.table)
library(ggplot2)
snippets <- read.csv(file = '22_snippet_occurrences.csv')
head(snippets)
snippet_table <- table(snippets$AA_MISMATCHES)
print(snippet_table)
# get data and organize it as a data frame
df <- data.frame(group = c(rep(snippets$SEQUENCE_PAIRS)),
values = snippets$AA_MISMATCHES)
# PLOT ################################################
# Plotting the snippet table. Basic plot. Numbers along the x-axis
# correspond to the columns, and y-values to row entries for each column in
# the snippet_table above.
plot(snippet_table)
# a slightly more aesthetic visualization with title and x-, y-labels.
barplot(snippet_table,
col='dark red',
sep='black',
main="Frequency vs. Pairs",
xlab="Snippet Occurrence Frequency",
ylab="Spike Protein Sequence Pairs",
xlim=c(0,30),
ylim=c(0,40)
)
# another plot, trying different params to check output
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "identity", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
# (5) another plot
ggplot(df) +
geom_col(aes(group, values, fill = group), stat = "identity", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
# (5) another plot, using a different function to compare results
ggplot(df) +
geom_col(aes(group, values, fill = group), stat = "identity", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
rlang::last_error()
# clean environment
rm(list = ls())
# Detach packages
detach("Package:ggplot2", unload = TRUE)
detach("package:data.table", unload = TRUE)
# Remove plots
dev.off()
# Clean console
cat("\014")
library(data.table)
library(ggplot2)
snippets <- read.csv(file = '22_snippet_occurrences.csv')
head(snippets)
snippet_table <- table(snippets$AA_MISMATCHES)
print(snippet_table)
numberIDs <- length(snippets$SEQUENCE_PAIRS)
print(numberIDs)
# get data and organize it as a data frame
df <- data.frame(group = c(rep(snippets$SEQUENCE_PAIRS)),
values = snippets$AA_MISMATCHES)
# another way to get data, with x-values being the 1st, 2nd, ..., nth id in file
# as the x-values.
# get data and organize it as a data frame
dfTwo <- data.frame(group = c(seq(1, numberIDs, 1)),
values = snippets$AA_MISMATCHES)
# PLOT ################################################
# Plotting the snippet table. Basic plot. Numbers along the x-axis
# correspond to the columns, and y-values to row entries for each column in
# the snippet_table above.
plot(snippet_table,
main="Frequency vs. Pairs",
xlab="Snippet Occurrence Frequency",
ylab="Spike Protein Sequence Pairs")
# a slightly more aesthetic visualization with title and x-, y-labels.
barplot(snippet_table,
col='dark red',
main="Frequency vs. Pairs",
xlab="Snippet Occurrence Frequency",
ylab="Spike Protein Sequence Pairs",
xlim=c(0,30),
ylim=c(0,40)
)
print(length(snippets$SEQUENCE_PAIRS))
print(length(numberIDs))
# using ggplots2 library, plot with x-labels being the accession ID pairs
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "identity", width = .8) +
ylab("Snippet Frequency") +
ylab("Snippet Frequency") +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
# another plot, barplot, trying numeric representation of accession data
ggplot(df) +
geom_bar(aes(group, values, fill = group), stat = "identity", width = .8) +
ylab("Snippet Frequency") +
scale_x_discrete(name="Sequence Pairs",
breaks = snippets$SEQUENCE_PAIRS,
labels= 1 : numberIDs) +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 5,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
rlang::last_error()
# (5) another plot
ggplot(dfTwo) +
geom_bar(aes(group, values, fill = group), stat = "identity", width = .8) +
ylab("Snippet Frequency") +
xlab("Sequence Pairs") +
scale_x_continuous(breaks = pretty(1 : numberIDs, n=153)) +
ggtitle("Snippet Occurrence Per Sequence Comparison") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45,
hjust = 1,
size = 6,
margin = margin(r=0)),
plot.title = element_text(hjust = 0.5))
rlang::last_error()
barplotFrame <- data.frame('accession_id_pair'=snippets$SEQUENCE_PAIRS)
print(barplotFrame)
write.csv(barplotFrame, file='BarPlotX-LabelLegend.csv')
